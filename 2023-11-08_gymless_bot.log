2023-11-08 01:35:48,494 - INFO - создаем команды боту
2023-11-08 01:35:48,709 - INFO - bot commands = [<telebot.types.BotCommand object at 0x101f36bc0>, <telebot.types.BotCommand object at 0x101f36b90>, <telebot.types.BotCommand object at 0x101f371c0>, <telebot.types.BotCommand object at 0x101f37520>, <telebot.types.BotCommand object at 0x101f371f0>, <telebot.types.BotCommand object at 0x101f37640>]
2023-11-08 01:36:00,885 - ERROR - Infinity polling: polling exited
2023-11-08 01:36:00,886 - ERROR - Break infinity polling
2023-11-08 01:36:01,195 - INFO - создаем команды боту
2023-11-08 01:36:06,469 - INFO - создаем команды боту
2023-11-08 01:36:06,667 - INFO - bot commands = <class 'list'>
2023-11-08 01:36:18,437 - ERROR - Infinity polling: polling exited
2023-11-08 01:36:18,437 - ERROR - Break infinity polling
2023-11-08 01:36:23,227 - INFO - создаем команды боту
2023-11-08 01:36:23,458 - INFO - bot commands = {'command': 'start', 'description': 'Главная'}
2023-11-08 01:39:40,564 - ERROR - Threaded polling exception: A request to the Telegram API was unsuccessful. Error code: 502. Description: Bad Gateway
2023-11-08 01:39:40,564 - ERROR - Exception traceback:
Traceback (most recent call last):
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/__init__.py", line 1073, in __threaded_polling
    polling_thread.raise_exceptions()
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/util.py", line 108, in raise_exceptions
    raise self.exception_info
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/__init__.py", line 649, in __retrieve_updates
    updates = self.get_updates(offset=(self.last_update_id + 1),
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/__init__.py", line 623, in get_updates
    json_updates = apihelper.get_updates(self.token, offset, limit, timeout, allowed_updates, long_polling_timeout)
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/apihelper.py", line 321, in get_updates
    return _make_request(token, method_url, params=payload)
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/apihelper.py", line 162, in _make_request
    json_result = _check_result(method_name, result)
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/apihelper.py", line 189, in _check_result
    raise ApiTelegramException(method_name, result, result_json)
telebot.apihelper.ApiTelegramException: A request to the Telegram API was unsuccessful. Error code: 502. Description: Bad Gateway

2023-11-08 01:39:40,877 - ERROR - Threaded polling exception: A request to the Telegram API was unsuccessful. Error code: 502. Description: Bad Gateway
2023-11-08 01:39:40,877 - ERROR - Exception traceback:
Traceback (most recent call last):
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/__init__.py", line 1073, in __threaded_polling
    polling_thread.raise_exceptions()
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/util.py", line 108, in raise_exceptions
    raise self.exception_info
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/__init__.py", line 649, in __retrieve_updates
    updates = self.get_updates(offset=(self.last_update_id + 1),
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/__init__.py", line 623, in get_updates
    json_updates = apihelper.get_updates(self.token, offset, limit, timeout, allowed_updates, long_polling_timeout)
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/apihelper.py", line 321, in get_updates
    return _make_request(token, method_url, params=payload)
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/apihelper.py", line 162, in _make_request
    json_result = _check_result(method_name, result)
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/apihelper.py", line 189, in _check_result
    raise ApiTelegramException(method_name, result, result_json)
telebot.apihelper.ApiTelegramException: A request to the Telegram API was unsuccessful. Error code: 502. Description: Bad Gateway

2023-11-08 01:39:41,446 - ERROR - Threaded polling exception: A request to the Telegram API was unsuccessful. Error code: 502. Description: Bad Gateway
2023-11-08 01:39:41,446 - ERROR - Exception traceback:
Traceback (most recent call last):
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/__init__.py", line 1073, in __threaded_polling
    polling_thread.raise_exceptions()
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/util.py", line 108, in raise_exceptions
    raise self.exception_info
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/__init__.py", line 649, in __retrieve_updates
    updates = self.get_updates(offset=(self.last_update_id + 1),
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/__init__.py", line 623, in get_updates
    json_updates = apihelper.get_updates(self.token, offset, limit, timeout, allowed_updates, long_polling_timeout)
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/apihelper.py", line 321, in get_updates
    return _make_request(token, method_url, params=payload)
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/apihelper.py", line 162, in _make_request
    json_result = _check_result(method_name, result)
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/apihelper.py", line 189, in _check_result
    raise ApiTelegramException(method_name, result, result_json)
telebot.apihelper.ApiTelegramException: A request to the Telegram API was unsuccessful. Error code: 502. Description: Bad Gateway

2023-11-08 01:40:07,465 - ERROR - Infinity polling exception: HTTPSConnectionPool(host='api.telegram.org', port=443): Read timed out. (read timeout=25)
2023-11-08 01:40:07,465 - ERROR - Exception traceback:
Traceback (most recent call last):
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 537, in _make_request
    response = conn.getresponse()
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/urllib3/connection.py", line 461, in getresponse
    httplib_response = super().getresponse()
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/http/client.py", line 1374, in getresponse
    response.begin()
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/http/client.py", line 318, in begin
    version, status, reason = self._read_status()
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/http/client.py", line 279, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/ssl.py", line 1274, in recv_into
    return self.read(nbytes, buffer)
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/ssl.py", line 1130, in read
    return self._sslobj.read(len, buffer)
TimeoutError: The read operation timed out

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 845, in urlopen
    retries = retries.increment(
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 470, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 791, in urlopen
    response = self._make_request(
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 539, in _make_request
    self._raise_timeout(err=e, url=url, timeout_value=read_timeout)
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 371, in _raise_timeout
    raise ReadTimeoutError(
urllib3.exceptions.ReadTimeoutError: HTTPSConnectionPool(host='api.telegram.org', port=443): Read timed out. (read timeout=25)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/__init__.py", line 955, in infinity_polling
    self.polling(non_stop=True, timeout=timeout, long_polling_timeout=long_polling_timeout,
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/__init__.py", line 1043, in polling
    self.__threaded_polling(non_stop=non_stop, interval=interval, timeout=timeout, long_polling_timeout=long_polling_timeout,
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/__init__.py", line 1118, in __threaded_polling
    raise e
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/__init__.py", line 1073, in __threaded_polling
    polling_thread.raise_exceptions()
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/util.py", line 108, in raise_exceptions
    raise self.exception_info
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/__init__.py", line 649, in __retrieve_updates
    updates = self.get_updates(offset=(self.last_update_id + 1),
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/__init__.py", line 623, in get_updates
    json_updates = apihelper.get_updates(self.token, offset, limit, timeout, allowed_updates, long_polling_timeout)
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/apihelper.py", line 321, in get_updates
    return _make_request(token, method_url, params=payload)
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/apihelper.py", line 156, in _make_request
    result = _get_req_session().request(
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/requests/adapters.py", line 532, in send
    raise ReadTimeout(e, request=request)
requests.exceptions.ReadTimeout: HTTPSConnectionPool(host='api.telegram.org', port=443): Read timed out. (read timeout=25)

2023-11-08 02:21:10,845 - ERROR - Infinity polling: polling exited
2023-11-08 02:21:10,846 - ERROR - Break infinity polling
2023-11-08 02:21:26,320 - INFO - Новый пользователь с user_id: 802693897, добавляем его в базу данных и начинаем диалог
2023-11-08 02:21:26,557 - INFO - Для пользователя user_id: 802693897 нет контекста. Создаем контекст и счетчик токенов
2023-11-08 02:21:26,557 - INFO - Задаем system на промпт 1
2023-11-08 02:21:50,861 - INFO - Пользователь отправил голосовое сообщение. Вызываем whisper и конвертируем в текст
2023-11-08 02:21:51,281 - INFO - Получили голосовое сообщение от пользователя (user_id: 802693897),  file_info: {'file_id': 'AwACAgIAAxkBAAIMk2VKxo5bwFuV4ndd9gABjydayDjTUwACnDQAAl3uWErxs5TDGpNY5zME', 'file_unique_id': 'AgADnDQAAl3uWEo', 'file_size': 47349, 'file_path': 'voice/file_132.oga'}, передаем полученный файл в whisper
2023-11-08 02:21:51,284 - INFO - Записваем полученное голосовое сообщение
2023-11-08 02:21:51,285 - INFO - Голосовое успешно записано
2023-11-08 02:21:53,473 - INFO - Получили распознанный текст из голосового сообщения пользователя с user_id: 802693897, сообщение: Меня зовут Егор, мне 17. Я хочу делать отжимания, и дома у меня нет никакого спортивного инвентаря.
2023-11-08 02:21:53,473 - INFO - Добавляем полученный текст в контекст пользователя (user_id: 802693897)
2023-11-08 02:22:17,275 - INFO - Получили ответ от GPT. Ответ: Твоя анкета:
Имя: Егор
Возраст: 17
Уровень физической подготовки (от 1 до 10): 
Длительность занятия: 
Физические ограничения: 
Наличие спортивного инвентаря: Нет
Пожелания по упражнениям: Отжимания

Уточни, пожалуйста, свой уровень физической подготовки (от 1 до 10) и длительность занятия.
2023-11-08 02:22:17,275 - INFO - Cчитаем токены для пользователя (user_id: 802693897), итого prompt_1 = 568
2023-11-08 02:22:17,275 - INFO - Переходим к уточняющим вопросам, если они нужны
2023-11-08 02:22:58,331 - INFO - Ответ пользователя (check_form): 5, 40 минут в день
2023-11-08 02:22:58,332 - INFO - Добавляем ответ пользователя в контекст
2023-11-08 02:22:58,332 - INFO - context: [{'role': 'system', 'content': "Твоя задача сделать анкету по данным предоставлеными пользователем. Формат анкеты следующий:имя,пол,возраст,уровень физической подготовки (от 1 до 10),длительность занятия, физические ограничения,наличие спортивного инвентаря,пожелания по упражнениям. Не задавай вопрос про пол (гендер) пользователя,определи пол по имени. Общайся с пользователем на «ты». Задавай уточняющие вопросы до тех пор пока анкету не заполнишь полностью. Задавай вопросы строго по анкете. Обязательно спроси у пользователя возраст. Задавай по два вопроса за раз. Пиши кратко, не повторяй слова пользователя, не давай лишних комментариев. Начни сообщение с анкетой со слов 'Твоя анкета' .По завершению анкеты, спроси, все ли верно с ней и спроси нужно ли что-то исправить. Не выдавай анкету до тех пор пока она полностью не будет заполнена."}, {'role': 'user', 'content': 'Меня зовут Егор, мне 17. Я хочу делать отжимания, и дома у меня нет никакого спортивного инвентаря.'}, {'role': 'assistant', 'content': 'Твоя анкета:\nИмя: Егор\nВозраст: 17\nУровень физической подготовки (от 1 до 10): \nДлительность занятия: \nФизические ограничения: \nНаличие спортивного инвентаря: Нет\nПожелания по упражнениям: Отжимания\n\nУточни, пожалуйста, свой уровень физической подготовки (от 1 до 10) и длительность занятия.'}, {'role': 'user', 'content': '5, 40 минут в день'}]
2023-11-08 02:23:18,920 - INFO - Ответ от GPT получен. Ответ: Твоя анкета:
Имя: Егор
Возраст: 17
Уровень физической подготовки: 5
Длительность занятия: 40 минут
Физические ограничения: 
Наличие спортивного инвентаря: Нет
Пожелания по упражнениям: Отжимания

Все ли верно с анкетой? Если нужно что-то исправить, пожалуйста, укажи что именно.
2023-11-08 02:23:18,922 - INFO - Считаем токены для пользователя (user_id: 802693897): 802693897, итого prompt_1 = 1297
2023-11-08 02:23:18,922 - INFO - Проверяем, есть ли слово тригер(анкета) в ответе от GPT
2023-11-08 02:23:18,922 - INFO - {
  "id": "chatcmpl-8IPhKcV5ITVdRYvForLHtFZsH284Q",
  "object": "chat.completion",
  "created": 1699399378,
  "model": "gpt-3.5-turbo-0613",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "\u0422\u0432\u043e\u044f \u0430\u043d\u043a\u0435\u0442\u0430:\n\u0418\u043c\u044f: \u0415\u0433\u043e\u0440\n\u0412\u043e\u0437\u0440\u0430\u0441\u0442: 17\n\u0423\u0440\u043e\u0432\u0435\u043d\u044c \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u043e\u0439 \u043f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0438: 5\n\u0414\u043b\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0437\u0430\u043d\u044f\u0442\u0438\u044f: 40 \u043c\u0438\u043d\u0443\u0442\n\u0424\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u044f: \n\u041d\u0430\u043b\u0438\u0447\u0438\u0435 \u0441\u043f\u043e\u0440\u0442\u0438\u0432\u043d\u043e\u0433\u043e \u0438\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u044f: \u041d\u0435\u0442\n\u041f\u043e\u0436\u0435\u043b\u0430\u043d\u0438\u044f \u043f\u043e \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u044f\u043c: \u041e\u0442\u0436\u0438\u043c\u0430\u043d\u0438\u044f\n\n\u0412\u0441\u0435 \u043b\u0438 \u0432\u0435\u0440\u043d\u043e \u0441 \u0430\u043d\u043a\u0435\u0442\u043e\u0439? \u0415\u0441\u043b\u0438 \u043d\u0443\u0436\u043d\u043e \u0447\u0442\u043e-\u0442\u043e \u0438\u0441\u043f\u0440\u0430\u0432\u0438\u0442\u044c, \u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0443\u043a\u0430\u0436\u0438 \u0447\u0442\u043e \u0438\u043c\u0435\u043d\u043d\u043e."
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 585,
    "completion_tokens": 144,
    "total_tokens": 729
  }
}
2023-11-08 02:23:18,922 - INFO - Слово тригре в ответе от GPT, выдаем клаваиатуру, если ответ пользователя положительный, переходим к промпту 2
2023-11-08 02:23:45,732 - INFO - Переходим к финальной проверке анкеты пользователя. Ответ пользователя на форму: У меня болит колено еще
2023-11-08 02:23:45,733 - INFO - context: [{'role': 'system', 'content': "Твоя задача сделать анкету по данным предоставлеными пользователем. Формат анкеты следующий:имя,пол,возраст,уровень физической подготовки (от 1 до 10),длительность занятия, физические ограничения,наличие спортивного инвентаря,пожелания по упражнениям. Не задавай вопрос про пол (гендер) пользователя,определи пол по имени. Общайся с пользователем на «ты». Задавай уточняющие вопросы до тех пор пока анкету не заполнишь полностью. Задавай вопросы строго по анкете. Обязательно спроси у пользователя возраст. Задавай по два вопроса за раз. Пиши кратко, не повторяй слова пользователя, не давай лишних комментариев. Начни сообщение с анкетой со слов 'Твоя анкета' .По завершению анкеты, спроси, все ли верно с ней и спроси нужно ли что-то исправить. Не выдавай анкету до тех пор пока она полностью не будет заполнена."}, {'role': 'user', 'content': 'Меня зовут Егор, мне 17. Я хочу делать отжимания, и дома у меня нет никакого спортивного инвентаря.'}, {'role': 'assistant', 'content': 'Твоя анкета:\nИмя: Егор\nВозраст: 17\nУровень физической подготовки (от 1 до 10): \nДлительность занятия: \nФизические ограничения: \nНаличие спортивного инвентаря: Нет\nПожелания по упражнениям: Отжимания\n\nУточни, пожалуйста, свой уровень физической подготовки (от 1 до 10) и длительность занятия.'}, {'role': 'user', 'content': '5, 40 минут в день'}, {'role': 'user', 'content': 'У меня болит колено еще'}]
2023-11-08 02:24:10,215 - INFO - текущие токены пользователя: 802693897 prompt_1=2051
2023-11-08 02:24:36,533 - INFO - Ответ пользователя (check_form): Да
2023-11-08 02:24:36,534 - INFO - Добавляем ответ пользователя в контекст
2023-11-08 02:24:36,534 - INFO - context: [{'role': 'system', 'content': "Твоя задача сделать анкету по данным предоставлеными пользователем. Формат анкеты следующий:имя,пол,возраст,уровень физической подготовки (от 1 до 10),длительность занятия, физические ограничения,наличие спортивного инвентаря,пожелания по упражнениям. Не задавай вопрос про пол (гендер) пользователя,определи пол по имени. Общайся с пользователем на «ты». Задавай уточняющие вопросы до тех пор пока анкету не заполнишь полностью. Задавай вопросы строго по анкете. Обязательно спроси у пользователя возраст. Задавай по два вопроса за раз. Пиши кратко, не повторяй слова пользователя, не давай лишних комментариев. Начни сообщение с анкетой со слов 'Твоя анкета' .По завершению анкеты, спроси, все ли верно с ней и спроси нужно ли что-то исправить. Не выдавай анкету до тех пор пока она полностью не будет заполнена."}, {'role': 'user', 'content': 'Меня зовут Егор, мне 17. Я хочу делать отжимания, и дома у меня нет никакого спортивного инвентаря.'}, {'role': 'assistant', 'content': 'Твоя анкета:\nИмя: Егор\nВозраст: 17\nУровень физической подготовки (от 1 до 10): \nДлительность занятия: \nФизические ограничения: \nНаличие спортивного инвентаря: Нет\nПожелания по упражнениям: Отжимания\n\nУточни, пожалуйста, свой уровень физической подготовки (от 1 до 10) и длительность занятия.'}, {'role': 'user', 'content': '5, 40 минут в день'}, {'role': 'user', 'content': 'У меня болит колено еще'}, {'role': 'user', 'content': 'Да'}]
2023-11-08 02:24:47,699 - INFO - Ответ от GPT получен. Ответ: Твоя анкета:
Имя: Егор
Возраст: 17
Уровень физической подготовки: 5
Длительность занятия: 40 минут в день
Физические ограничения: Боль в колене
Наличие спортивного инвентаря: Нет
Пожелания по упражнениям: Отжимания

Все верно? Если нужно что-то исправить или добавить, пожалуйста, скажи.
2023-11-08 02:24:47,699 - INFO - Считаем токены для пользователя (user_id: 802693897): 802693897, итого prompt_1 = 2801
2023-11-08 02:24:47,699 - INFO - Проверяем, есть ли слово тригер(анкета) в ответе от GPT
2023-11-08 02:24:47,700 - INFO - {
  "id": "chatcmpl-8IPiuqg3ByVhYB7P23u1uAvjRE1Fx",
  "object": "chat.completion",
  "created": 1699399476,
  "model": "gpt-3.5-turbo-0613",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "\u0422\u0432\u043e\u044f \u0430\u043d\u043a\u0435\u0442\u0430:\n\u0418\u043c\u044f: \u0415\u0433\u043e\u0440\n\u0412\u043e\u0437\u0440\u0430\u0441\u0442: 17\n\u0423\u0440\u043e\u0432\u0435\u043d\u044c \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u043e\u0439 \u043f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0438: 5\n\u0414\u043b\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0437\u0430\u043d\u044f\u0442\u0438\u044f: 40 \u043c\u0438\u043d\u0443\u0442 \u0432 \u0434\u0435\u043d\u044c\n\u0424\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u044f: \u0411\u043e\u043b\u044c \u0432 \u043a\u043e\u043b\u0435\u043d\u0435\n\u041d\u0430\u043b\u0438\u0447\u0438\u0435 \u0441\u043f\u043e\u0440\u0442\u0438\u0432\u043d\u043e\u0433\u043e \u0438\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u044f: \u041d\u0435\u0442\n\u041f\u043e\u0436\u0435\u043b\u0430\u043d\u0438\u044f \u043f\u043e \u0443\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u044f\u043c: \u041e\u0442\u0436\u0438\u043c\u0430\u043d\u0438\u044f\n\n\u0412\u0441\u0435 \u0432\u0435\u0440\u043d\u043e? \u0415\u0441\u043b\u0438 \u043d\u0443\u0436\u043d\u043e \u0447\u0442\u043e-\u0442\u043e \u0438\u0441\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0438\u043b\u0438 \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c, \u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0441\u043a\u0430\u0436\u0438."
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 606,
    "completion_tokens": 144,
    "total_tokens": 750
  }
}
2023-11-08 02:24:47,700 - INFO - Слово тригре в ответе от GPT, выдаем клаваиатуру, если ответ пользователя положительный, переходим к промпту 2
2023-11-08 02:24:50,459 - INFO - Переходим к финальной проверке анкеты пользователя. Ответ пользователя на форму: Да
2023-11-08 02:24:50,460 - INFO - Пользователь (user_id: 802693897) подтвердил корректность анкеты, начианем составлять для него программу
2023-11-08 02:24:50,545 - INFO - Перед составлением программы, получаем заполненую форму пользователя без лишнего текста, для того, чтобы передать ее в промпт 2
2023-11-08 02:25:01,782 - INFO - Получили форму пользователя (user_id: 802693897), форма: Твоя анкета:
Имя: Егор
Возраст: 17
Уровень физической подготовки: 5
Длительность занятия: 40 минут в день
Физические ограничения: Боль в колене
Наличие спортивного инвентаря: Нет
Пожелания по упражнениям: Отжимания

Все верно? Если нужно что-то исправить, пожалуйста, укажи что именно., передаем ее во 2 промпт
2023-11-08 02:25:01,783 - INFO - Считаем токены для пользователя (user_id: 802693897): 802693897, итого prompt_1 = 3565
2023-11-08 02:25:01,783 - INFO - Создаем программу на основе полученной формы (анкеты), ждем ответ от GPT
2023-11-08 02:25:19,975 - INFO - Ответ от GPT получен, программа готова: {
  "id": "chatcmpl-8IPjKestZWOPq3gN3LWTI0mM0AhMa",
  "object": "chat.completion",
  "created": 1699399502,
  "model": "gpt-4-1106-preview",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "*\u0420\u0430\u0437\u043c\u0438\u043d\u043a\u0430:*\n\n*1. \u041f\u0440\u043e\u0433\u0443\u043b\u043a\u0430 \u043d\u0430 \u043c\u0435\u0441\u0442\u0435: (5 \u043c\u0438\u043d\u0443\u0442) {\u041f\u043e\u0441\u0442\u0435\u043f\u0435\u043d\u043d\u043e \u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0432\u0430\u0439 \u0442\u0435\u043c\u043f, \u043f\u043e\u0434\u043d\u0438\u043c\u0430\u0439 \u043a\u043e\u043b\u0435\u043d\u0438 \u0432\u044b\u0448\u0435, \u0440\u0430\u0437\u043c\u0430\u0445\u0438\u0432\u0430\u0439 \u0440\u0443\u043a\u0430\u043c\u0438}*\n\n*2. \u0420\u0430\u0437\u043c\u0438\u043d\u043a\u0430 \u043f\u043b\u0435\u0447: (2 \u043f\u043e\u0434\u0445\u043e\u0434\u0430, 1 \u043c\u0438\u043d\u0443\u0442\u0430) {\u0412\u044b\u043f\u043e\u043b\u043d\u044f\u0439 \u043a\u0440\u0443\u0433\u043e\u0432\u044b\u0435 \u0434\u0432\u0438\u0436\u0435\u043d\u0438\u044f \u043f\u043b\u0435\u0447\u0430\u043c\u0438, \u0441\u043d\u0430\u0447\u0430\u043b\u0430 \u0432\u043f\u0435\u0440\u0435\u0434, \u0437\u0430\u0442\u0435\u043c \u043d\u0430\u0437\u0430\u0434}*\n\n*3. \u041d\u0430\u043a\u043b\u043e\u043d\u044b \u0442\u0443\u043b\u043e\u0432\u0438\u0449\u0430: (2 \u043f\u043e\u0434\u0445\u043e\u0434\u0430, 10 \u043f\u043e\u0432\u0442\u043e\u0440\u0435\u043d\u0438\u0439) {\u0421\u0442\u043e\u044f \u043f\u0440\u044f\u043c\u043e, \u043d\u0430\u043a\u043b\u043e\u043d\u044f\u0439\u0441\u044f \u0432 \u0441\u0442\u043e\u0440\u043e\u043d\u044b, \u0441\u0442\u0430\u0440\u0430\u044f\u0441\u044c \u0434\u043e\u0442\u044f\u043d\u0443\u0442\u044c\u0441\u044f \u0440\u0443\u043a\u043e\u0439 \u0434\u043e \u0431\u0435\u0434\u0440\u0430}*\n\n*4. \u0420\u0430\u0441\u0442\u044f\u0436\u043a\u0430 \u0438\u043a\u0440\u044b: (2 \u043f\u043e\u0434\u0445\u043e\u0434\u0430, 30 \u0441\u0435\u043a\u0443\u043d\u0434 \u043d\u0430 \u043d\u043e\u0433\u0443) {\u0412\u0441\u0442\u0430\u043d\u044c \u043b\u0438\u0446\u043e\u043c \u043a \u0441\u0442\u0435\u043d\u0435, \u043e\u0434\u043d\u0443 \u043d\u043e\u0433\u0443 \u043e\u0442\u0441\u0442\u0430\u0432\u044c \u043d\u0430\u0437\u0430\u0434, \u043a\u0430\u0441\u0430\u044f\u0441\u044c \u043f\u044f\u0442\u043a\u043e\u0439 \u043f\u043e\u043b\u0430, \u0434\u0440\u0443\u0433\u0443\u044e \u043d\u043e\u0433\u0443 \u0441\u043e\u0433\u043d\u0438 \u0432 \u043a\u043e\u043b\u0435\u043d\u0435}*\n\n*\u041e\u0441\u043d\u043e\u0432\u043d\u0430\u044f \u0447\u0430\u0441\u0442\u044c:*\n\n*1. \u041e\u0442\u0436\u0438\u043c\u0430\u043d\u0438\u044f: (3 \u043f\u043e\u0434\u0445\u043e\u0434\u0430, 10-15 \u043f\u043e\u0432\u0442\u043e\u0440\u0435\u043d\u0438\u0439) {\u041f\u0440\u0438\u043d\u0438\u043c\u0430\u0439 \u0443\u043f\u043e\u0440 \u043b\u0435\u0436\u0430, \u0440\u0443\u043a\u0438 \u043d\u0430 \u0448\u0438\u0440\u0438\u043d\u0435 \u043f\u043b\u0435\u0447, \u0442\u0435\u043b\u043e \u043f\u0440\u044f\u043c\u043e\u0435. \u041e\u043f\u0443\u0441\u043a\u0430\u0439\u0441\u044f, \u043f\u043e\u043a\u0430 \u0433\u0440\u0443\u0434\u044c \u043f\u043e\u0447\u0442\u0438 \u043d\u0435 \u043a\u043e\u0441\u043d\u0435\u0442\u0441\u044f \u043f\u043e\u043b\u0430, \u0437\u0430\u0442\u0435\u043c \u043f\u043e\u0434\u043d\u0438\u043c\u0430\u0439\u0441\u044f}*\n\n*2. \u041f\u043b\u0430\u043d\u043a\u0430: (3 \u043f\u043e\u0434\u0445\u043e\u0434\u0430, 30 \u0441\u0435\u043a\u0443\u043d\u0434) {\u041f\u0440\u0438\u043c\u0438 \u0443\u043f\u043e\u0440 \u043d\u0430 \u043f\u0440\u0435\u0434\u043f\u043b\u0435\u0447\u044c\u044f, \u0442\u0435\u043b\u043e \u0434\u043e\u043b\u0436\u043d\u043e \u043e\u0431\u0440\u0430\u0437\u043e\u0432\u044b\u0432\u0430\u0442\u044c \u043f\u0440\u044f\u043c\u0443\u044e \u043b\u0438\u043d\u0438\u044e \u043e\u0442 \u043f\u043b\u0435\u0447 \u0434\u043e \u043f\u044f\u0442\u043e\u043a}*\n\n*3. \u0411\u0435\u0440\u043f\u0438: (3 \u043f\u043e\u0434\u0445\u043e\u0434\u0430, 8-10 \u043f\u043e\u0432\u0442\u043e\u0440\u0435\u043d\u0438\u0439) {\u0418\u0437 \u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0441\u0442\u043e\u044f \u043e\u043f\u0443\u0441\u043a\u0430\u0439\u0441\u044f \u0432 \u043f\u0440\u0438\u0441\u0435\u0434, \u0437\u0430\u0442\u0435\u043c \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u0438 \u0432 \u0443\u043f\u043e\u0440 \u043b\u0435\u0436\u0430, \u0441\u0434\u0435\u043b\u0430\u0439 \u043e\u0442\u0436\u0438\u043c\u0430\u043d\u0438\u0435, \u0432\u0435\u0440\u043d\u0438\u0441\u044c \u0432 \u043f\u0440\u0438\u0441\u0435\u0434 \u0438 \u043f\u0440\u044b\u0433\u043d\u0438 \u0432\u0432\u0435\u0440\u0445} {\u0441 \u043e\u0441\u0442\u043e\u0440\u043e\u0436\u043d\u043e\u0441\u0442\u044c\u044e \u0438\u0437-\u0437\u0430 \u0431\u043e\u043b\u044c \u0432 \u043a\u043e\u043b\u0435\u043d\u0435}*\n\n*4. \u041f\u043e\u0434\u044a\u0435\u043c\u044b \u0442\u0443\u043b\u043e\u0432\u0438\u0449\u0430: (3 \u043f\u043e\u0434\u0445\u043e\u0434\u0430, 15 \u043f\u043e\u0432\u0442\u043e\u0440\u0435\u043d\u0438\u0439) {\u041b\u044f\u0433 \u043d\u0430 \u0441\u043f\u0438\u043d\u0443, \u0440\u0443\u043a\u0438 \u0437\u0430 \u0433\u043e\u043b\u043e\u0432\u043e\u0439, \u043f\u043e\u0434\u043d\u0438\u043c\u0430\u0439 \u0432\u0435\u0440\u0445\u043d\u044e\u044e \u0447\u0430\u0441\u0442\u044c \u0442\u0443\u043b\u043e\u0432\u0438\u0449\u0430 \u043a \u043a\u043e\u043b\u0435\u043d\u044f\u043c}*\n\n*\u0417\u0430\u043c\u0438\u043d\u043a\u0430:*\n\n*1. \u0420\u0430\u0441\u0442\u044f\u0436\u043a\u0430 \u043a\u0432\u0430\u0434\u0440\u0438\u0446\u0435\u043f\u0441\u0430: (2 \u043f\u043e\u0434\u0445\u043e\u0434\u0430, 30 \u0441\u0435\u043a\u0443\u043d\u0434 \u043d\u0430 \u043d\u043e\u0433\u0443) {\u0421\u0442\u043e\u044f, \u0441\u043e\u0433\u043d\u0438 \u043d\u043e\u0433\u0443 \u0432 \u043a\u043e\u043b\u0435\u043d\u0435, \u0437\u0430\u0445\u0432\u0430\u0442\u0438 \u0441\u0442\u043e\u043f\u0443 \u0440\u0443\u043a\u043e\u0439 \u0438 \u043f\u043e\u0442\u044f\u043d\u0438 \u043a \u044f\u0433\u043e\u0434\u0438\u0446\u0430\u043c} {\u0441 \u043e\u0441\u0442\u043e\u0440\u043e\u0436\u043d\u043e\u0441\u0442\u044c\u044e \u0438\u0437-\u0437\u0430 \u0431\u043e\u043b\u044c \u0432 \u043a\u043e\u043b\u0435\u043d\u0435}*\n\n*2. \u0420\u0430\u0441\u0442\u044f\u0436\u043a\u0430 \u0433\u0440\u0443\u0434\u043d\u044b\u0445 \u043c\u044b\u0448\u0446: (2 \u043f\u043e\u0434\u0445\u043e\u0434\u0430, 30 \u0441\u0435\u043a\u0443\u043d\u0434) {\u0412\u0441\u0442\u0430\u043d\u044c \u0432 \u0434\u0432\u0435\u0440\u043d\u043e\u0439 \u043f\u0440\u043e\u0435\u043c, \u0440\u0443\u043a\u0438 \u043d\u0430 \u0443\u0440\u043e\u0432\u043d\u0435 \u043f\u043b\u0435\u0447, \u0441\u043e\u0433\u043d\u0438 \u043b\u043e\u043a\u0442\u0438 \u043f\u043e\u0434 \u0443\u0433\u043b\u043e\u043c 90 \u0433\u0440\u0430\u0434\u0443\u0441\u043e\u0432 \u0438 \u043c\u044f\u0433\u043a\u043e \u043d\u0430\u043a\u043b\u043e\u043d\u044f\u0439\u0441\u044f \u0432\u043f\u0435\u0440\u0435\u0434}*\n\n*3. \u041f\u043e\u0437\u0430 \u0440\u0435\u0431\u0435\u043d\u043a\u0430: (1 \u043f\u043e\u0434\u0445\u043e\u0434, 1 \u043c\u0438\u043d\u0443\u0442\u0430) {\u0421\u044f\u0434\u044c \u043d\u0430 \u043a\u043e\u0440\u0442\u043e\u0447\u043a\u0438, \u043e\u043f\u0443\u0441\u0442\u0438 \u0442\u0443\u043b\u043e\u0432\u0438\u0449\u0435 \u043c\u0435\u0436\u0434\u0443 \u0431\u0435\u0434\u0440\u0430\u043c\u0438, \u043b\u043e\u0431 \u043d\u0430 \u043f\u043e\u043b, \u0440\u0443\u043a\u0438 \u0432\u044b\u0442\u044f\u043d\u0438 \u0432\u043f\u0435\u0440\u0435\u0434 \u0438\u043b\u0438 \u043f\u043e\u043b\u043e\u0436\u0438 \u0432\u0434\u043e\u043b\u044c \u0442\u0435\u043b\u0430}*\n\n*4. \u0420\u0430\u0441\u0442\u044f\u0436\u043a\u0430 \u0441\u043f\u0438\u043d\u044b: (1 \u043f\u043e\u0434\u0445\u043e\u0434, 1 \u043c\u0438\u043d\u0443\u0442\u0430) {\u041b\u044f\u0433 \u043d\u0430 \u0441\u043f\u0438\u043d\u0443, \u043f\u043e\u0434\u0442\u044f\u043d\u0438 \u043a\u043e\u043b\u0435\u043d\u0438 \u043a \u0433\u0440\u0443\u0434\u0438 \u0438 \u043e\u0431\u0445\u0432\u0430\u0442\u0438 \u0438\u0445 \u0440\u0443\u043a\u0430\u043c\u0438}*\n\n\u041f\u043e\u0434\u0445\u043e\u0434\u0438\u0442 \u043b\u0438 \u0442\u0435\u0431\u0435 \u043f\u0440\u0435\u0434\u043b\u043e\u0436\u0435\u043d\u043d\u0430\u044f \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0430 \u0438\u043b\u0438 \u0435\u0441\u0442\u044c \u0447\u0442\u043e-\u0442\u043e, \u0447\u0442\u043e \u0442\u044b \u0445\u043e\u0442\u0435\u043b \u0431\u044b \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c?"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 744,
    "completion_tokens": 952,
    "total_tokens": 1696
  },
  "system_fingerprint": "fp_a24b4d720c"
}
2023-11-08 02:25:19,976 - INFO - Считаем текущие токены пользователя (user_id: 802693897): итого prompt_2=1696
2023-11-08 02:25:56,302 - INFO - from check_program Замени растяжку спины
2023-11-08 02:26:23,745 - INFO - текущие токены пользователя: 802693897 prompt_2=3633
2023-11-08 02:26:33,291 - INFO - from check_program Да
2023-11-08 02:26:33,431 - INFO - Сохраняем программу для пользователя 802693897
2023-11-08 02:27:52,425 - INFO - программа Программа тренировки для Егора:

Разминка:
*1. Прогулка на месте: (5 минут) {Постепенно увеличивай темп, поднимай колени выше, размахивай руками}*
*2. Повороты головы: (10 повторений в каждую сторону) {Медленно поворачивай голову вправо, затем влево, стараясь достичь максимального поворота}*
*3. Разведение рук: (10 повторений) {Встань прямо, руки опусти вниз, затем медленно подними и разведи в стороны, затем верни в исходное положение}*
*4. Приседания: (10 повторений) {Стань прямо, ноги на ширине плеч, медленно приседай, сохраняя правильную форму, затем вернись в исходное положение}*

Основная часть (силовая):
*1. Отжимания: (3 подхода по 10 повторений) {Встань в планку, руки на ширине плеч, медленно опускайся, сгибая локти, затем поднимайся обратно в исходное положение}*
*2. Приседания с прыжком: (3 подхода по 10 повторений) {Стань прямо, ноги на ширине плеч, медленно приседай, затем сделай прыжок вверх, выпрямляя ноги}*
*3. Подтягивания на перекладине: (3 подхода по 5 повторений) {Возьмися за перекладину, руки на ширине плеч, медленно подтягивайся, поднимая грудь к перекладине, затем медленно опускайся}*
*4. Планка: (3 подхода по 30 секунд) {Встань в планку, опираясь на предплечья и носки, сохраняй прямую линию от головы до пяток}*

Заминка:
*1. Растяжка ног: (10 повторений в каждую ногу) {Сядь на пол, одну ногу вытяни вперед, другую согни в колене и прижми к себе, почувствуй растяжение в задней части бедра}*
*2. Растяжка плеч: (10 повторений в каждую руку) {Встань прямо, одну руку подними вверх, согни ее в локте и положи ладонь на спину, другой рукой придави локоть к телу, почувствуй растяжение в плече}*
*3. Растяжка спины: (10 повторений) {Встань прямо, согни туловище вперед, опустив голову и руки, почувствуй растяжение в спине}*
*4. Растяжка и расслабление шеи: (10 повторений) {Сядь на стул, наклони голову вперед, пытаясь дотянуться подбородком до груди, затем медленно поворачивай голову вправо и влево, ощущая растяжение в шее}*

Пожалуйста, ознакомься с программой тренировки. Если что-то не подходит или нужно внести изменения, дай мне знать.
2023-11-08 02:29:23,003 - ERROR - Infinity polling: polling exited
2023-11-08 02:29:23,003 - ERROR - Break infinity polling
2023-11-08 02:30:17,701 - INFO - Новый пользователь с user_id: 802693897, добавляем его в базу данных и начинаем диалог
2023-11-08 02:30:17,932 - INFO - Для пользователя user_id: 802693897 нет контекста. Создаем контекст и счетчик токенов
2023-11-08 02:30:17,932 - INFO - Задаем system на промпт 1
2023-11-08 02:30:30,474 - INFO - Пользователь отправил голосовое сообщение. Вызываем whisper и конвертируем в текст
2023-11-08 02:30:30,799 - INFO - Получили голосовое сообщение от пользователя (user_id: 802693897),  file_info: {'file_id': 'AwACAgIAAxkBAAIMpmVKyJaxnwABNFk4HvDsrKc0UO3D3QACnjQAAl3uWEqNiIbbqkROrTME', 'file_unique_id': 'AgADnjQAAl3uWEo', 'file_size': 33278, 'file_path': 'voice/file_133.oga'}, передаем полученный файл в whisper
2023-11-08 02:30:30,800 - INFO - Записваем полученное голосовое сообщение
2023-11-08 02:30:30,802 - INFO - Голосовое успешно записано
2023-11-08 02:30:33,560 - INFO - Получили распознанный текст из голосового сообщения пользователя с user_id: 802693897, сообщение: Привет, меня зовут Егор, мне 17, я хочу делать отжимания, у меня нет никакого спортивного инвентаря.
2023-11-08 02:30:33,561 - INFO - Добавляем полученный текст в контекст пользователя (user_id: 802693897)
2023-11-08 02:30:47,706 - INFO - Получили ответ от GPT. Ответ: Твоя анкета:
Имя: Егор
Возраст: 17
Уровень физической подготовки (от 1 до 10): не указан
Длительность занятия: не указана
Физические ограничения: нет
Наличие спортивного инвентаря: нет
Пожелания по упражнениям: отжимания

Уточни, пожалуйста, свой уровень физической подготовки (от 1 до 10) и длительность занятия.
2023-11-08 02:30:47,707 - INFO - Cчитаем токены для пользователя (user_id: 802693897), итого prompt_1 = 572
2023-11-08 02:30:47,707 - INFO - Переходим к уточняющим вопросам, если они нужны
2023-11-08 02:31:31,067 - INFO - Ответ пользователя (check_form): 10, 40
Минут в день, болит левое колено еще
2023-11-08 02:31:31,068 - INFO - Добавляем ответ пользователя в контекст
2023-11-08 02:31:46,228 - INFO - Ответ от GPT получен. Ответ: Твоя анкета:
Имя: Егор
Возраст: 17
Уровень физической подготовки: 10
Длительность занятия: 40 минут
Физические ограничения: болит левое колено
Наличие спортивного инвентаря: нет
Пожелания по упражнениям: отжимания

Спасибо за заполнение анкеты! Проверь, пожалуйста, все ли верно указано. Если есть что-то, что нужно исправить, пожалуйста, сообщи.
2023-11-08 02:31:46,229 - INFO - Считаем токены для пользователя (user_id: 802693897): 802693897, итого prompt_1 = 1344
2023-11-08 02:31:46,229 - INFO - Проверяем, есть ли слово тригер(анкета) в ответе от GPT
2023-11-08 02:31:46,229 - INFO - Слово тригре в ответе от GPT, выдаем клаваиатуру, если ответ пользователя положительный, переходим к промпту 2
2023-11-08 02:31:53,112 - INFO - Переходим к финальной проверке анкеты пользователя. Ответ пользователя на форму: Да
2023-11-08 02:31:53,113 - INFO - Пользователь (user_id: 802693897) подтвердил корректность анкеты, начианем составлять для него программу
2023-11-08 02:31:53,205 - INFO - Перед составлением программы, получаем заполненую форму пользователя без лишнего текста, для того, чтобы передать ее в промпт 2
2023-11-08 02:32:05,774 - INFO - Получили форму пользователя (user_id: 802693897), форма: Твоя анкета:
Имя: Егор
Возраст: 17
Уровень физической подготовки: 10
Длительность занятия: 40 минут
Физические ограничения: болит левое колено
Наличие спортивного инвентаря: нет
Пожелания по упражнениям: отжимания

Все ли верно с анкетой? Если нужно что-то исправить, пожалуйста, укажи что именно., передаем ее во 2 промпт
2023-11-08 02:32:05,775 - INFO - Считаем токены для пользователя (user_id: 802693897): 802693897, итого prompt_1 = 2109
2023-11-08 02:32:05,775 - INFO - Создаем программу на основе полученной формы (анкеты), ждем ответ от GPT
2023-11-08 02:32:36,264 - INFO - Ответ от GPT получен, программа готова: Программа тренировок для Егора:

*Разминка:*

*1. Прогулка на месте: (3 минуты) {Ходи на месте, поднимая колени высоко и размахивая руками в унисон с шагами}*

*2. Растяжка квадрицепсов: (2 подхода, по 30 секунд на каждую ногу) {Стоя, сгибай одну ногу в колене, забирая пятку к ягодицам, другой рукой держись за опору. Повтори на другую ногу. Будь осторожен с левым коленом}*

*3. Повороты туловища: (2 подхода, 15 повторений) {Встань прямо, ноги на ширине плеч, руки на талии. Поворачивай туловище влево и вправо, не двигая ногами}*

*4. Махи руками: (2 подхода, 15 повторений) {Встань прямо, руки в стороны. Делай круговые движения руками, сначала вперед, затем назад}*

*Основная часть:*

*1. Отжимания: (3 подхода, 15-20 повторений) {Прими упор лежа, руки на ширине плеч. Опускай торс вниз, не касаясь грудью пола, и возвращайся в исходное положение}*

*2. Планка: (3 подхода, по 30-60 секунд) {Прими упор на предплечья и носки ног, тело должно образовывать прямую линию от головы до пяток}*

*3. Приседания без нагрузки: (2 подхода, 15 повторений) {Встань прямо, ноги на ширине плеч. Приседай, отводя таз назад, как будто садишься на стул. Следи за тем, чтобы колени не выходили за линию носков. Будь осторожен с левым коленом}*

*4. Берпи без прыжка: (3 подхода, 10 повторений) {Из положения стоя опусти руки на пол, перейди в планку, затем вернись в исходное положение стоя. Избегай резких движений, чтобы не нагружать колено}*

*Заминка:*

*1. Растяжка икроножных мышц: (2 подхода, по 30 секунд на каждую ногу) {Встань на одну ногу, другую вытяни назад, касаясь пяткой пола. Смените ногу}*

*2. Растяжка грудных мышц: (2 подхода, по 30 секунд) {Встань в дверном проеме, руки на уровне плеч, ладони на косяке. Шагни вперед, чувствуя растяжение в грудных мышцах}*

*3. Растяжка спины: (2 подхода, по 30 секунд) {Сидя на полу, ноги прямо, тянись руками к носкам, не сгибая колени}*

*4. Дыхательные упражнения: (3 минуты) {Сделай глубокий вдох носом, задержи дыхание на несколько секунд, медленно выдыхай через рот}*

Подходит ли тебе предложенная программа или есть что-то, что ты хотел бы изменить?
2023-11-08 02:32:36,265 - INFO - Считаем текущие токены пользователя (user_id: 802693897): итого prompt_2=1828
2023-11-08 02:32:42,827 - INFO - from check_program Да
2023-11-08 02:32:43,040 - INFO - Сохраняем программу для пользователя 802693897
2023-11-08 02:33:40,951 - INFO - программа Привет, Егор! Основываясь на твоей анкете, я составил для тебя индивидуальную программу тренировок дома. Проверь ее и скажи, подходит ли она тебе или есть что-то, что нужно изменить.

Разминка:
*1. Прогулка на месте: (5 минут) {Постепенно увеличивай темп, поднимай колени выше, размахивай руками}*
*2. Растяжка ног: (2 повторения по 30 секунд на каждую ногу) {Сядь на пол, вытяни одну ногу вперед и наклонись вперед, стараясь дотянуться до носка}*
*3. Вращение плечами: (2 повторения по 10 раз в каждую сторону) {Встань прямо, руки опусти вдоль тела и начни вращать плечами вперед и назад}*

Основная часть (силовая):
*1. Отжимания: (3 подхода по 10 повторений) {Встань в планку, руки на ширине плеч, опусти тело вниз, сгибая руки, а затем поднимись обратно в исходное положение}*
*2. Приседания: (3 подхода по 12 повторений) {Встань прямо, ноги на ширине плеч, медленно сядь, сгибая колени, и затем поднимись обратно в исходное положение}*
*3. Планка: (3 подхода по 30 секунд) {Встань в планку, опираясь на предплечья и носки, держи тело прямым и напряженным}*

Заминка:
*1. Растяжка спины: (2 повторения по 30 секунд) {Ляг на спину, согни одну ногу и поверни ее в сторону, держа другую ногу прямой}*
*2. Растяжка грудных мышц: (2 повторения по 30 секунд) {Встань прямо, сцепи руки за спиной и медленно подними их вверх, растягивая грудные мышцы}*

Обрати внимание, что из-за боли в левом колене, с осторожностью выполняй приседания. Если у тебя возникнут какие-либо проблемы или ты захочешь что-то изменить, дай мне знать. Я готов внести изменения в программу тренировок.
2023-11-08 02:33:50,116 - INFO - Получаем упраженения из бд для пользователя 802693897
2023-11-08 02:33:50,116 - INFO - Получили упражнения пользователя, из количество - 8, упражнения - ['1. Прогулка на месте: (5 минут) {Постепенно увеличивай темп, поднимай колени выше, размахивай руками}', '2. Растяжка ног: (2 повторения по 30 секунд на каждую ногу) {Сядь на пол, вытяни одну ногу вперед и наклонись вперед, стараясь дотянуться до носка}', '3. Вращение плечами: (2 повторения по 10 раз в каждую сторону) {Встань прямо, руки опусти вдоль тела и начни вращать плечами вперед и назад}', '1. Отжимания: (3 подхода по 10 повторений) {Встань в планку, руки на ширине плеч, опусти тело вниз, сгибая руки, а затем поднимись обратно в исходное положение}', '2. Приседания: (3 подхода по 12 повторений) {Встань прямо, ноги на ширине плеч, медленно сядь, сгибая колени, и затем поднимись обратно в исходное положение}', '3. Планка: (3 подхода по 30 секунд) {Встань в планку, опираясь на предплечья и носки, держи тело прямым и напряженным}', '1. Растяжка спины: (2 повторения по 30 секунд) {Ляг на спину, согни одну ногу и поверни ее в сторону, держа другую ногу прямой}', '2. Растяжка грудных мышц: (2 повторения по 30 секунд) {Встань прямо, сцепи руки за спиной и медленно подними их вверх, растягивая грудные мышцы}']
2023-11-08 02:33:52,568 - INFO - Я выполнил упражнение
2023-11-08 02:33:56,584 - INFO - Пропустить отдых, 1, ['1. Прогулка на месте: (5 минут) {Постепенно увеличивай темп, поднимай колени выше, размахивай руками}', '2. Растяжка ног: (2 повторения по 30 секунд на каждую ногу) {Сядь на пол, вытяни одну ногу вперед и наклонись вперед, стараясь дотянуться до носка}', '3. Вращение плечами: (2 повторения по 10 раз в каждую сторону) {Встань прямо, руки опусти вдоль тела и начни вращать плечами вперед и назад}', '1. Отжимания: (3 подхода по 10 повторений) {Встань в планку, руки на ширине плеч, опусти тело вниз, сгибая руки, а затем поднимись обратно в исходное положение}', '2. Приседания: (3 подхода по 12 повторений) {Встань прямо, ноги на ширине плеч, медленно сядь, сгибая колени, и затем поднимись обратно в исходное положение}', '3. Планка: (3 подхода по 30 секунд) {Встань в планку, опираясь на предплечья и носки, держи тело прямым и напряженным}', '1. Растяжка спины: (2 повторения по 30 секунд) {Ляг на спину, согни одну ногу и поверни ее в сторону, держа другую ногу прямой}', '2. Растяжка грудных мышц: (2 повторения по 30 секунд) {Встань прямо, сцепи руки за спиной и медленно подними их вверх, растягивая грудные мышцы}']
2023-11-08 02:34:02,012 - INFO - Я выполнил упражнение
2023-11-08 02:34:06,114 - INFO - Пропустить отдых, 2, ['1. Прогулка на месте: (5 минут) {Постепенно увеличивай темп, поднимай колени выше, размахивай руками}', '2. Растяжка ног: (2 повторения по 30 секунд на каждую ногу) {Сядь на пол, вытяни одну ногу вперед и наклонись вперед, стараясь дотянуться до носка}', '3. Вращение плечами: (2 повторения по 10 раз в каждую сторону) {Встань прямо, руки опусти вдоль тела и начни вращать плечами вперед и назад}', '1. Отжимания: (3 подхода по 10 повторений) {Встань в планку, руки на ширине плеч, опусти тело вниз, сгибая руки, а затем поднимись обратно в исходное положение}', '2. Приседания: (3 подхода по 12 повторений) {Встань прямо, ноги на ширине плеч, медленно сядь, сгибая колени, и затем поднимись обратно в исходное положение}', '3. Планка: (3 подхода по 30 секунд) {Встань в планку, опираясь на предплечья и носки, держи тело прямым и напряженным}', '1. Растяжка спины: (2 повторения по 30 секунд) {Ляг на спину, согни одну ногу и поверни ее в сторону, держа другую ногу прямой}', '2. Растяжка грудных мышц: (2 повторения по 30 секунд) {Встань прямо, сцепи руки за спиной и медленно подними их вверх, растягивая грудные мышцы}']
2023-11-08 02:34:07,132 - INFO - Я выполнил упражнение
2023-11-08 02:34:07,954 - INFO - Пропустить отдых, 3, ['1. Прогулка на месте: (5 минут) {Постепенно увеличивай темп, поднимай колени выше, размахивай руками}', '2. Растяжка ног: (2 повторения по 30 секунд на каждую ногу) {Сядь на пол, вытяни одну ногу вперед и наклонись вперед, стараясь дотянуться до носка}', '3. Вращение плечами: (2 повторения по 10 раз в каждую сторону) {Встань прямо, руки опусти вдоль тела и начни вращать плечами вперед и назад}', '1. Отжимания: (3 подхода по 10 повторений) {Встань в планку, руки на ширине плеч, опусти тело вниз, сгибая руки, а затем поднимись обратно в исходное положение}', '2. Приседания: (3 подхода по 12 повторений) {Встань прямо, ноги на ширине плеч, медленно сядь, сгибая колени, и затем поднимись обратно в исходное положение}', '3. Планка: (3 подхода по 30 секунд) {Встань в планку, опираясь на предплечья и носки, держи тело прямым и напряженным}', '1. Растяжка спины: (2 повторения по 30 секунд) {Ляг на спину, согни одну ногу и поверни ее в сторону, держа другую ногу прямой}', '2. Растяжка грудных мышц: (2 повторения по 30 секунд) {Встань прямо, сцепи руки за спиной и медленно подними их вверх, растягивая грудные мышцы}']
2023-11-08 02:34:08,770 - INFO - Я выполнил упражнение
2023-11-08 02:34:09,589 - INFO - Пропустить отдых, 4, ['1. Прогулка на месте: (5 минут) {Постепенно увеличивай темп, поднимай колени выше, размахивай руками}', '2. Растяжка ног: (2 повторения по 30 секунд на каждую ногу) {Сядь на пол, вытяни одну ногу вперед и наклонись вперед, стараясь дотянуться до носка}', '3. Вращение плечами: (2 повторения по 10 раз в каждую сторону) {Встань прямо, руки опусти вдоль тела и начни вращать плечами вперед и назад}', '1. Отжимания: (3 подхода по 10 повторений) {Встань в планку, руки на ширине плеч, опусти тело вниз, сгибая руки, а затем поднимись обратно в исходное положение}', '2. Приседания: (3 подхода по 12 повторений) {Встань прямо, ноги на ширине плеч, медленно сядь, сгибая колени, и затем поднимись обратно в исходное положение}', '3. Планка: (3 подхода по 30 секунд) {Встань в планку, опираясь на предплечья и носки, держи тело прямым и напряженным}', '1. Растяжка спины: (2 повторения по 30 секунд) {Ляг на спину, согни одну ногу и поверни ее в сторону, держа другую ногу прямой}', '2. Растяжка грудных мышц: (2 повторения по 30 секунд) {Встань прямо, сцепи руки за спиной и медленно подними их вверх, растягивая грудные мышцы}']
2023-11-08 02:34:10,410 - INFO - Я выполнил упражнение
2023-11-08 02:34:11,229 - INFO - Пропустить отдых, 5, ['1. Прогулка на месте: (5 минут) {Постепенно увеличивай темп, поднимай колени выше, размахивай руками}', '2. Растяжка ног: (2 повторения по 30 секунд на каждую ногу) {Сядь на пол, вытяни одну ногу вперед и наклонись вперед, стараясь дотянуться до носка}', '3. Вращение плечами: (2 повторения по 10 раз в каждую сторону) {Встань прямо, руки опусти вдоль тела и начни вращать плечами вперед и назад}', '1. Отжимания: (3 подхода по 10 повторений) {Встань в планку, руки на ширине плеч, опусти тело вниз, сгибая руки, а затем поднимись обратно в исходное положение}', '2. Приседания: (3 подхода по 12 повторений) {Встань прямо, ноги на ширине плеч, медленно сядь, сгибая колени, и затем поднимись обратно в исходное положение}', '3. Планка: (3 подхода по 30 секунд) {Встань в планку, опираясь на предплечья и носки, держи тело прямым и напряженным}', '1. Растяжка спины: (2 повторения по 30 секунд) {Ляг на спину, согни одну ногу и поверни ее в сторону, держа другую ногу прямой}', '2. Растяжка грудных мышц: (2 повторения по 30 секунд) {Встань прямо, сцепи руки за спиной и медленно подними их вверх, растягивая грудные мышцы}']
2023-11-08 02:34:12,047 - INFO - Я выполнил упражнение
2023-11-08 02:34:13,684 - INFO - Пропустить отдых, 6, ['1. Прогулка на месте: (5 минут) {Постепенно увеличивай темп, поднимай колени выше, размахивай руками}', '2. Растяжка ног: (2 повторения по 30 секунд на каждую ногу) {Сядь на пол, вытяни одну ногу вперед и наклонись вперед, стараясь дотянуться до носка}', '3. Вращение плечами: (2 повторения по 10 раз в каждую сторону) {Встань прямо, руки опусти вдоль тела и начни вращать плечами вперед и назад}', '1. Отжимания: (3 подхода по 10 повторений) {Встань в планку, руки на ширине плеч, опусти тело вниз, сгибая руки, а затем поднимись обратно в исходное положение}', '2. Приседания: (3 подхода по 12 повторений) {Встань прямо, ноги на ширине плеч, медленно сядь, сгибая колени, и затем поднимись обратно в исходное положение}', '3. Планка: (3 подхода по 30 секунд) {Встань в планку, опираясь на предплечья и носки, держи тело прямым и напряженным}', '1. Растяжка спины: (2 повторения по 30 секунд) {Ляг на спину, согни одну ногу и поверни ее в сторону, держа другую ногу прямой}', '2. Растяжка грудных мышц: (2 повторения по 30 секунд) {Встань прямо, сцепи руки за спиной и медленно подними их вверх, растягивая грудные мышцы}']
2023-11-08 02:34:14,715 - INFO - Я выполнил упражнение
2023-11-08 02:34:15,529 - INFO - Пропустить отдых, 7, ['1. Прогулка на месте: (5 минут) {Постепенно увеличивай темп, поднимай колени выше, размахивай руками}', '2. Растяжка ног: (2 повторения по 30 секунд на каждую ногу) {Сядь на пол, вытяни одну ногу вперед и наклонись вперед, стараясь дотянуться до носка}', '3. Вращение плечами: (2 повторения по 10 раз в каждую сторону) {Встань прямо, руки опусти вдоль тела и начни вращать плечами вперед и назад}', '1. Отжимания: (3 подхода по 10 повторений) {Встань в планку, руки на ширине плеч, опусти тело вниз, сгибая руки, а затем поднимись обратно в исходное положение}', '2. Приседания: (3 подхода по 12 повторений) {Встань прямо, ноги на ширине плеч, медленно сядь, сгибая колени, и затем поднимись обратно в исходное положение}', '3. Планка: (3 подхода по 30 секунд) {Встань в планку, опираясь на предплечья и носки, держи тело прямым и напряженным}', '1. Растяжка спины: (2 повторения по 30 секунд) {Ляг на спину, согни одну ногу и поверни ее в сторону, держа другую ногу прямой}', '2. Растяжка грудных мышц: (2 повторения по 30 секунд) {Встань прямо, сцепи руки за спиной и медленно подними их вверх, растягивая грудные мышцы}']
2023-11-08 02:34:16,450 - INFO - Я выполнил упражнение
2023-11-08 02:34:17,269 - INFO - Пропустить отдых, 8, ['1. Прогулка на месте: (5 минут) {Постепенно увеличивай темп, поднимай колени выше, размахивай руками}', '2. Растяжка ног: (2 повторения по 30 секунд на каждую ногу) {Сядь на пол, вытяни одну ногу вперед и наклонись вперед, стараясь дотянуться до носка}', '3. Вращение плечами: (2 повторения по 10 раз в каждую сторону) {Встань прямо, руки опусти вдоль тела и начни вращать плечами вперед и назад}', '1. Отжимания: (3 подхода по 10 повторений) {Встань в планку, руки на ширине плеч, опусти тело вниз, сгибая руки, а затем поднимись обратно в исходное положение}', '2. Приседания: (3 подхода по 12 повторений) {Встань прямо, ноги на ширине плеч, медленно сядь, сгибая колени, и затем поднимись обратно в исходное положение}', '3. Планка: (3 подхода по 30 секунд) {Встань в планку, опираясь на предплечья и носки, держи тело прямым и напряженным}', '1. Растяжка спины: (2 повторения по 30 секунд) {Ляг на спину, согни одну ногу и поверни ее в сторону, держа другую ногу прямой}', '2. Растяжка грудных мышц: (2 повторения по 30 секунд) {Встань прямо, сцепи руки за спиной и медленно подними их вверх, растягивая грудные мышцы}']
2023-11-08 02:34:38,012 - INFO - Пользователь с user_id: 802693897 уже существует
2023-11-08 02:35:35,996 - ERROR - Infinity polling: polling exited
2023-11-08 02:35:35,996 - ERROR - Break infinity polling
2023-11-08 02:35:39,219 - INFO - Пользователь с user_id: 802693897 уже существует
2023-11-08 02:35:48,607 - ERROR - Infinity polling: polling exited
2023-11-08 02:35:48,607 - ERROR - Break infinity polling
2023-11-08 02:35:50,868 - INFO - Пользователь с user_id: 802693897 уже существует
2023-11-08 02:35:58,853 - ERROR - Infinity polling: polling exited
2023-11-08 02:35:58,853 - ERROR - Break infinity polling
2023-11-08 02:36:01,515 - INFO - Пользователь с user_id: 802693897 уже существует
2023-11-08 02:36:24,749 - ERROR - Infinity polling: polling exited
2023-11-08 02:36:24,750 - ERROR - Break infinity polling
2023-11-08 02:36:26,864 - INFO - Пользователь с user_id: 802693897 уже существует
2023-11-08 02:37:03,059 - ERROR - Infinity polling: polling exited
2023-11-08 02:37:03,059 - ERROR - Break infinity polling
2023-11-08 02:37:30,426 - INFO - Новый пользователь с user_id: 802693897, добавляем его в базу данных и начинаем диалог
2023-11-08 02:37:30,637 - INFO - Для пользователя user_id: 802693897 нет контекста. Создаем контекст и счетчик токенов
2023-11-08 02:37:30,638 - INFO - Задаем system на промпт 1
2023-11-08 02:38:16,798 - INFO - Пользователь отправил текстоовое сообщение
2023-11-08 02:38:17,018 - INFO - Сообщение пользователя (user_id: 802693897): Я Егор, мне 17, хочу отжимания, инвентаря нет, болит колено, хочу тратить 40 минут в день, уровень физической подготовки 10
2023-11-08 02:38:17,019 - INFO - Добавляем полученный текст в контекст пользователя (user_id: 802693897)
2023-11-08 02:38:20,431 - INFO - error_code=insufficient_quota error_message='You exceeded your current quota, please check your plan and billing details.' error_param=None error_type=insufficient_quota message='OpenAI API error received' stream_error=False
2023-11-08 02:38:20,437 - ERROR - Infinity polling exception: You exceeded your current quota, please check your plan and billing details.
2023-11-08 02:38:20,441 - ERROR - Exception traceback:
Traceback (most recent call last):
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/__init__.py", line 955, in infinity_polling
    self.polling(non_stop=True, timeout=timeout, long_polling_timeout=long_polling_timeout,
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/__init__.py", line 1043, in polling
    self.__threaded_polling(non_stop=non_stop, interval=interval, timeout=timeout, long_polling_timeout=long_polling_timeout,
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/__init__.py", line 1118, in __threaded_polling
    raise e
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/__init__.py", line 1074, in __threaded_polling
    self.worker_pool.raise_exceptions()
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/util.py", line 147, in raise_exceptions
    raise self.exception_info
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
  File "/Users/ekondrashov/PycharmProjects/openai/main.py", line 119, in get_info
    form_completion = openai.ChatCompletion.create(
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/openai/api_resources/chat_completion.py", line 25, in create
    return super().create(*args, **kwargs)
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 155, in create
    response, _, api_key = requestor.request(
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/openai/api_requestor.py", line 299, in request
    resp, got_stream = self._interpret_response(result, stream)
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/openai/api_requestor.py", line 710, in _interpret_response
    self._interpret_response_line(
  File "/Users/ekondrashov/PycharmProjects/openai/venv/lib/python3.10/site-packages/openai/api_requestor.py", line 775, in _interpret_response_line
    raise self.handle_error_response(
openai.error.RateLimitError: You exceeded your current quota, please check your plan and billing details.

2023-11-08 02:38:37,745 - ERROR - Infinity polling: polling exited
2023-11-08 02:38:37,745 - ERROR - Break infinity polling
